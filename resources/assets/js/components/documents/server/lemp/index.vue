<template>
  <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h1 class="text-center">LEMP stack trÃªn Ubuntu 16.04</h1>
      </div>
      <div class="panel-body">
        <h3>Giá»›i thiá»‡u</h3>
        <p>LEMP stack lÃ  má»™t nhÃ³m cÃ¡c pháº§n má»m Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ táº¡o nÃªn má»™t web server xá»­ lÃ½ ngÃ´n ngá»¯ PHP. NhÃ³m pháº§n má»m nÃ y gá»“m há»‡ Ä‘iá»u hÃ nh Linux, pháº§n má»m cháº¡y dá»‹ch vá»¥ web server lÃ  Nginx. CÆ¡ sá»Ÿ dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ trÃªn MySQL vÃ  ngÃ´n ngá»¯ Ä‘á»™ng PHP.
        </p>

        <h3>Chuáº©n bá»‹ cÃ i Ä‘áº·t LEMP stack</h3>
        <p>
          TrÆ°á»›c khi tiáº¿n hÃ nh cÃ i Ä‘áº·t, báº¡n pháº£i cháº¯c cháº¯n ráº±ng báº¡n cÃ³ tÃ i khoáº£n root hoáº·c tÃ i khoáº£n thÃ´ng thÆ°á»ng vá»›i quyá»n sudo. Náº¿u báº¡n táº¡o server á»Ÿ Vultr, báº¡n sáº½ Ä‘Æ°á»£c cung cáº¥p tÃ i khoáº£n root, báº¡n cÃ³ thá»ƒ káº¿t ná»‘i SSH hoáº·c sá»­ dá»¥ng terminal cá»§a Vultr.
        </p>
        <p>
          HÃ£y Ä‘Äƒng nháº­p vá»›i quyá»n nhÆ° trÃªn vÃ o server. Äáº§u tiÃªn chÃºng ta sáº½ update server cá»§a chÃºng ta báº±ng lá»‡nh update:
        </p>
        <code>sudo apt-get update</code>
        <p>
          Viá»‡c nÃ y sáº½ cáº­p nháº­t láº¡i danh má»¥c cÃ¡c gÃ³i cÃ i Ä‘áº·t ná»™i bá»™ trÃªn server. TrÆ°á»›c khi báº¯t Ä‘áº§u cÃ i Ä‘áº·t báº¡n nÃªn cháº¡y lá»‡nh update 1 láº§n lÃºc Ä‘Äƒng nháº­p vÃ o server. BÃ¢y giá» chÃºng ta hÃ£y báº¯t Ä‘áº§u cÃ i Ä‘áº·t LEMP Stack!
        </p>


        <h3>BÆ°á»›c 1: CÃ i Ä‘áº·t Nginx web server</h3>
        <p>
          Web server lÃ  nÆ¡i xá»­ lÃ½ cÃ¡c yÃªu cáº§u tá»« trÃ¬nh duyá»‡t. Nginx lÃ  má»™t web server hiá»‡n Ä‘áº¡i vÃ  cÃ³ hiá»‡u nÄƒng xá»­ lÃ½ cao. Hiá»‡n nay ráº¥t nhiá»u hÃ£ng tÃªn tuá»•i cÅ©ng sá»­ dá»¥ng Nginx cho web server cá»§a há».
        </p>
        <p>
          HÃ£y cháº¯c cháº¯n ráº±ng báº¡n Ä‘Ã£ cháº¡y lá»‡nh update trÆ°á»›c khi cÃ i Nginx. Lá»‡nh sau sáº½ tá»± Ä‘á»™ng cÃ i Ä‘áº·t Nginx vÃ o há»‡ thá»‘ng.
        </p>
        <code>sudo apt-get -y install nginx</code>
        <p>
          Sau khi cÃ i Ä‘áº·t xong, hÃ£y thá»­ má»Ÿ trÃ¬nh duyá»‡t vÃ  truy cáº­p vÃ o server cá»§a báº¡n Ä‘á»ƒ xem káº¿t quáº£. Náº¿u báº¡n chÆ°a cÃ³ tÃªn miá»n trá» vá» server, báº¡n cÃ³ thá»ƒ thá»­ truy cáº­p báº±ng IP public cá»§a server. <code>curl -4 IP</code>. Khi Ä‘Ã£ biáº¿t Ä‘á»‹a chá»‰ IP cá»§a server, hÃ£y má»Ÿ trÃ¬nh duyá»‡t vÃ  gÃµ Ä‘á»‹a chá»‰ IP vÃ o kiá»ƒm thá»­.
        </p>

        <h3>BÆ°á»›c 2: CÃ i Ä‘áº·t Mysql</h3>
        <p>
            CÃ i Ä‘áº·t mysql báº±ng lá»‡nh <code>sudo apt-get -y install mysql-server </code>. Báº¡n sáº½ Ä‘Æ°á»£c yÃªu cáº§u nháº­p máº­t kháº©u cho tÃ i khoáº£n root Ä‘á»ƒ sá»­ dá»¥ng trong há»‡ thá»‘ng Mysql. Sau khi cÃ i Ä‘áº·t xong MySQL, chÃºng ta váº«n chÆ°a sá»­ dá»¥ng Ä‘Æ°á»£c vÃ¬ MySQL cáº§n Ä‘Æ°á»£c cáº¥u hÃ¬nh trÆ°á»›c khi sá»­ dá»¥ng. ChÃºng ta sáº½ cáº¥u hÃ¬nh má»™t cÃ¡ch báº£o máº­t báº±ng lá»‡nh sudo <code>mysql_secure_installation</code> Báº¡n sáº½ Ä‘Æ°á»£c yÃªu cáº§u nháº­p máº­t kháº©u root mÃ  báº¡n Ä‘Ã£ Ä‘áº·t á»Ÿ bÆ°á»›c trÃªn. Tiáº¿p theo báº¡n sáº½ Ä‘Æ°á»£c há»i cÃ³ muá»‘n cáº¥u hÃ¬nh VALIDATE PASSWORD PLUGIN khÃ´ng.
            <span>LÆ°u Ã½: VALIDATE PASSWORD PLUGIN lÃ  má»™t tÃ­nh nÄƒng kiá»ƒm tra máº­t kháº©u cÃ³ thá»a mÃ£n cÃ¡c tiÃªu chÃ­ Ä‘áº·t ra hay khÃ´ng. Báº¡n cÃ³ thá»ƒ sá»­ dá»¥ng hoáº·c khÃ´ng sá»­ dá»¥ng tÃ­nh nÄƒng nÃ y. Tuy nhiÃªn hÃ£y luÃ´n sá»­ dá»¥ng máº­t kháº©u phá»©c táº¡p. Nháº­p y Ä‘á»ƒ cáº¥u hÃ¬nh VALIDATE PASSWORD PLUGIN hoáº·c báº¥t kÃ¬ kÃ­ tá»± khÃ¡c Ä‘á»ƒ bá» qua tÃ­nh nÄƒng nÃ y.</span>
            <span>Pháº§n cÃ²n láº¡i sau cÃ¢u há»i nÃ y, báº¡n hÃ£y báº¥m Y vÃ  báº¥m Enter cho táº¥t cáº£ cÃ¡c cÃ¢u há»i cÃ²n láº¡i. Viá»‡c nÃ y sáº½ xÃ³a bá» cÃ¡c tÃ i khoáº£n vÃ´ danh, cÃ¡c test database, khÃ³a chá»©c nÄƒng Ä‘Äƒng nháº­p tá»« xa cho tÃ i khoáº£n root vÃ  táº£i má»™t sá»‘ quy Ä‘á»‹nh má»›i. NhÆ° váº­y MySQL sáº½ ngay láº­p tá»©c Ã¡p dá»¥ng cÃ¡c thay Ä‘á»•i mÃ  chÃºng ta vá»«a cÃ i Ä‘áº·t. BÃ¢y giá» há»‡ thá»‘ng database cá»§a báº¡n Ä‘Ã£ Ä‘Æ°á»£c cÃ i Ä‘áº·t hoÃ n táº¥t vÃ  chÃºng ta sáº½ tiáº¿p tá»¥c vá»›i viá»‡c cÃ i Ä‘áº·t PHP.</span>
        </p>

        <h3>BÆ°á»›c 3: CÃ i Ä‘áº·t PHP</h3>
        <p>
            ChÃºng ta Ä‘Ã£ cÃ i Ä‘áº·t Nginx Ä‘á»ƒ lÃ m web server vÃ  MySQL Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u. Tiáº¿p theo cá»§a viá»‡c cÃ i Ä‘áº·t lemp stack Ä‘Ã³ lÃ  cÃ i Ä‘áº·t PHP Ä‘á»ƒ xá»­ lÃ½ cÃ¡c trang web Ä‘á»™ng. Má»™t Ä‘iá»u lÆ°u Ã½ lÃ  Nginx khÃ´ng há»— trá»£ xá»­ lÃ½ PHP thuáº§n nhÆ° nhá»¯ng web servers khÃ¡c (Apache, Httpd, v.vâ€¦). ChÃºng ta sáº½ cÃ i Ä‘áº·t php-fpm (FastCGI process manager) vÃ  cáº¥u hÃ¬nh cho Nginx Ä‘á»ƒ truyá»n cÃ¡c yÃªu cáº§u PHP sang FPM xá»­ lÃ½. ChÃºng ta cÃ³ thá»ƒ vá»«a cÃ i module nÃ y vÃ  má»™t vÃ i helper package (gÃ³i trá»£ giÃºp) giÃºp PHP cÃ³ thá»ƒ giao tiáº¿p vá»›i cÆ¡ sá»Ÿ dá»¯ liá»‡u. ChÃºng ta dÃ¹ng lá»‡nh sau <code>sudo apt-get -y install php-fpm php-mysql </code>. 
            BÃ¢y giá» chÃºng ta cáº§n thá»±c hiá»‡n cáº¥u hÃ¬nh Ä‘á»ƒ server Ä‘Æ°á»£c báº£o máº­t hÆ¡n. HÃ£y má»Ÿ file cáº¥u hÃ¬nh cá»§a php-fpm vá»›i quyá»n 
            <code>root sudo vi /etc/php/7.0/fpm/php.ini </code>HÃ£y tÃ¬m Ä‘áº¿n thÃ´ng sá»‘ <code>cgi.fix_pathinfo</code>, máº·c Ä‘á»‹nh nÃ³ Ä‘ang Ä‘Æ°á»£c comment báº±ng dáº¥u hai cháº¥m (ğŸ˜‰ vÃ  gÃ¡n giÃ¡ trá»‹ máº·c Ä‘á»‹nh â€œ1â€. ChÃºng ta sáº½ thay Ä‘á»•i báº±ng cÃ¡ch xÃ³a dáº¥u hai cháº¥m vÃ  gÃ¡n giÃ¡ trá»‹ báº±ng 0 nhÆ° sau cgi.fix_pathinfo=0 LÆ°u file vÃ  Ä‘Ã³ng láº¡i sau khi báº¡n chá»‰nh sá»­a xong. Äiá»u tiáº¿p theo cáº§n lÃ m Ä‘Ã³ lÃ  khá»Ÿi Ä‘á»™ng láº¡i PHP báº±ng cÃ¡ch <code>sudo service php7.0-fpm restart</code>
        </p>

        <h3>BÆ°á»›c 4: Cáº¥u hÃ¬nh Nginx vÃ  PHP</h3>
        <p>
            ChÃºng ta Ä‘Ã£ cÃ³ táº¥t cáº£ cÃ¡c thÃ nh pháº§n cáº§n thiáº¿t gá»“m Nginx, MySQL vÃ  PHP. Äiá»u cuá»‘i cÃ¹ng chÃºng ta cáº§n cáº¥u hÃ¬nh Ä‘Ã³ lÃ  giÃºp Nginx sá»­ dá»¥ng PHP cho cÃ¡c trang web Ä‘á»™ng. ChÃºng ta sáº½ cáº¥u hÃ¬nh trÃªn khá»‘i server (server block) cá»§a Nginx (cÃ¡c block nÃ y tÆ°Æ¡ng tá»± táº¡o host áº£o trÃªn Apache). HÃ£y má»Ÿ block máº·c Ä‘á»‹nh cá»§a Nginx báº±ng cÃ¡ch: <code>sudo vi /etc/nginx/sites-available/default</code> Báº¡n sáº½ tháº¥y ná»™i dung tÆ°Æ¡ng tá»± nhÆ° tháº¿ nÃ y (cÃ¡c dÃ²ng comment Ä‘Ã£ Ä‘Æ°á»£c mÃ¬nh bá» qua)
        </p>
        <pre><code><span class="hljs-section">server</span> {
        <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span> default_server;
        <span class="hljs-attribute">listen</span> [::]:<span class="hljs-number">80</span> default_server;
     
        <span class="hljs-attribute">root</span> /var/www/html;
        <span class="hljs-attribute">index</span> index.html index.htm index.nginx-debian.html;
     
        <span class="hljs-attribute">server_name</span> _;
     
        <span class="hljs-attribute">location</span> / {
            <span class="hljs-attribute">try_files</span> <span class="hljs-variable">$uri</span> <span class="hljs-variable">$uri</span>/ =<span class="hljs-number">404</span>;
        }
    }
    </code></pre>

        <ul>ChÃºng ta cáº§n thay Ä‘á»•i nhÆ° sau:
            <li> Äáº§u tiÃªn chÃºng ta cáº§n thÃªm index.php vÃ o giÃ¡ trá»‹ Ä‘áº§u tiÃªn cá»§a má»¥c index. Viá»‡c nÃ y giÃºp file index.php sáº½ Ä‘Æ°á»£c gá»i lÃªn khi xá»­ lÃ½ má»™t yÃªu cáº§u Ä‘áº¿n thÆ° má»¥c.</li>
            <li>ChÃºng ta cÃ³ thá»ƒ thay Ä‘á»•i má»¥c server_name Ä‘á»ƒ trá» Ä‘áº¿n tÃªn miá»n hoáº·c Ä‘á»‹a chá»‰ IP public.</li>
            <li>ChÃºng ta cáº§n bá» cÃ¡c dáº¥u comment cá»§a pháº§n PHP Ä‘á»ƒ Nginx biáº¿t cÃ¡ch xá»­ lÃ½ cÃ¡c yÃªu cáº§u Ä‘áº¿n file PHP nhÆ° tháº¿ nÃ o. ÄÃ¢y lÃ  pháº§n location ~.php$$</li>
            <li>ChÃºng ta cÅ©ng cÃ³ thá»ƒ cáº¥u hÃ¬nh cháº·n cÃ¡c yÃªu cáº§u Ä‘áº¿n file .htaccess. Nginx khÃ´ng há»— trá»£ cÃ¡c file nÃ y nhÆ°ng báº¡n cÅ©ng nÃªn cháº·n ngÆ°á»i dÃ¹ng truy cáº­p Ä‘áº¿n cÃ¡c file nÃ y. Sau khi thay Ä‘á»•i, file cáº¥u hÃ¬nh cá»§a chÃºng ta sáº½ cÃ³ ná»™i dung nhÆ° sau</li>
        </ul>
        <pre><code><span class="hljs-section">server</span> {
            <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span> default_server;
            <span class="hljs-attribute">listen</span> [::]:<span class="hljs-number">80</span> default_server;
         
            <span class="hljs-attribute">root</span> /var/www/html;
            <span class="hljs-attribute">index</span> index.php index.html index.htm index.nginx-debian.html;
         
            <span class="hljs-attribute">server_name</span> server_domain_or_IP;
         
            <span class="hljs-attribute">location</span> / {
                <span class="hljs-attribute">try_files</span> <span class="hljs-variable">$uri</span> <span class="hljs-variable">$uri</span>/ =<span class="hljs-number">404</span>;
            }
         
            <span class="hljs-attribute">location</span> <span class="hljs-regexp">~ \.php$</span> {
                <span class="hljs-attribute">include</span> snippets/fastcgi-php.conf;
                <span class="hljs-attribute">fastcgi_pass</span> unix:/run/php/php7.0-fpm.sock;
            }
         
            <span class="hljs-attribute">location</span> <span class="hljs-regexp">~ /\.ht</span> {
                <span class="hljs-attribute">deny</span> all;
            }
        }
        </code></pre>

        <p>
            Sau khi chá»‰nh sá»­a xong hÃ£y lÆ°u vÃ  Ä‘Ã³ng file láº¡i. BÃ¢y giá» hÃ£y kiá»ƒm thá»­ xem cáº¥u hÃ¬nh cá»§a chÃºng ta cÃ³ há»£p lá»‡ hay khÃ´ng trÆ°á»›c khi chÃºng ta cháº¡y láº¡i nginx báº±ng lá»‡nh <code>sudo nginx -t </code> Náº¿u cÃ³ lá»—i, hÃ£y quay láº¡i vÃ  kiá»ƒm tra file cáº¥u hÃ¬nh. Báº¡n hÃ£y Ä‘áº£m báº£o ráº±ng khÃ´ng cÃ³ báº¥t kÃ¬ lá»—i nÃ o á»Ÿ file cáº¥u hÃ¬nh trÆ°á»›c khi chÃºng ta khá»Ÿi Ä‘á»™ng láº¡i nginx. Äá»ƒ khá»Ÿi Ä‘á»™ng láº¡i nginx chÃºng ta dÃ¹ng lá»‡nh <code>sudo service nginx reload</code>
        </p>

        <h3>BÆ°á»›c 5: Táº¡o file PHP kiá»ƒm tra</h3>
        <p>
            ChÃºc má»«ng báº¡n Ä‘Ã£ cÃ i Ä‘áº·t xong LEMP Stack, viá»‡c cuá»‘i cÃ¹ng mÃ  chÃºng ta cáº§n lÃ m Ä‘Ã³ lÃ  táº¡o má»™t file PHP kiá»ƒm thá»­ xem cáº¥u hÃ¬nh Ä‘Ã£ Ä‘Ãºng háº¿t chÆ°a. BÃ¢y giá» hÃ£y táº¡o má»›i file info.php á»Ÿ thÆ° má»¥c web gá»‘c báº±ng cÃ¡ch <code>sudo vi /var/www/html/info.php</code> Ná»™i dung cá»§a file info.php nhÆ° sau
        </p>
        <pre><code>&lt;?<span class="hljs-function">php
<span class="hljs-title">phpinfo</span><span class="hljs-params">()</span></span>;
        </code></pre>

        <p>LÆ°u vÃ  Ä‘Ã³ng file láº¡i. BÃ¢y giá» báº¡n hÃ£y thá»­ dÃ¹ng trÃ¬nh duyá»‡t truy cáº­p vÃ o Ä‘á»‹a chá»‰ Ä‘áº¿n file nÃ y Ä‘á»ƒ kiá»ƒm tra thá»­ http://server_name/info.php hoáº·c http://ip_address/info.php Náº¿u báº¡n nhÃ¬n tháº¥y thÃ´ng tin dÆ°á»›i Ä‘Ã¢y thÃ¬ xin chÃºc má»«ng báº¡n Ä‘Ã£ cÃ i Ä‘áº·t hoÃ n táº¥t</p>
      </div>
    </div>
  </div>
</template>
<style type="text/css">
    p{
        line-height: 1.65;
        color: #0b1a33;
        font-size: 16px;
    }
    h3 {
        color: #000;
    }
    pre {
        background: #000 !important; 
        color: #fff !important;
    }
    .hljs-attribute {
        color: #98c379;
    }
    .hljs-section {
        color: #e06c75;
    }
    .hljs-number {
        color: #d19a66;
    }
    .hljs-title{
        color: #61aeee
    }
</style>